# 项目：又一个多色解决方案（针对 Klipper 3D 打印机）
**状态:** WIP / 初步概念  
**目标:** 在不重新发明轮子的情况下，最大化利用现有零件  

---

## 概述  

本项目探索一种*低成本*、*可改造*、*模块化*的多色 3D 打印方案 —— 无需昂贵的 AMS 系统或复杂的舵机机构。  

与其从零构建一个全新的多材料系统，不如将现有可靠的组件组合起来，让 **Klipper** 来进行整体协调。  

可以这样理解：  
> “四个挤出机 + 一个*智能缓冲器* = 一个功能完善的多色系统。”  

---

## 核心组件  

| 组件 | 描述 |
|------------|-------------|
| **主控** | 基于 Klipper 的主板（任何带备用输出的板子都可以） |
| **挤出机** | 标准 **BMG 风格挤出机** —— 每根通道一个 |
| **缓冲器** | **Mellow LLL 缓冲器** （这个是我能找到的相对比较便宜的了）|
| **传感器** | - 每个通道一个 **耗材传感器**（检测耗材插入）<br>- 工具头上一个 **耗材传感器**（检测 & 定时） |
| **工具头切刀** | 可选 —— 用于更高的换色成功率 |
| **MOSFET（x2）** | 用于模拟缓冲器控制板上的按钮（实现Klipper集成的关键部件） |

*无需额外安装硬件！全是现成零件，直接安装即可！*

---

## 概念  

有一天，我在考虑给我的 3D 打印机加一个缓冲器。然后我想到了：四个挤出机加一个缓冲器，基本上就是完美的多色系统。比舵机方案更简单、更稳定，也解决了那些烦人的同步问题。其实，根本不用我说 —— 只要看看 拓竹/创想三维 等厂商的做法，就能发现他们基本上在用同样的思路。  

但是在 DIY 3D 打印圈子里，据我所知，唯一用类似方案的就是 Box Turtle。问题是，他们的系统太复杂了：用了一块定制主板去驱动那些 N20 电机，还用了一堆铝型材作为结构件，成本飙升。当然，这么做也是有理由的 —— 毕竟他们要承载四卷耗材。  

我的方法不同：让专门的耗材储存箱去承担这些重活（我在仓库中附上了我使用的设计；你只需用一个常见的通用收纳箱，选好尺寸，打几个洞，打印出所有部件，然后安装进去），然后专注于多色系统的电子与机械设计。  

你可能会问：“等等，这不就是 MMU/ERCF 的想法吗？” 确实如此，但他们的设计仍然太复杂 —— 使用丝杆、光轴，甚至还需要舵机。所以，你可以把我的方案看作一个运行在普通 Klipper 主板上的 Box Turtle（无需特殊有刷电机驱动模块），使用现成的缓冲器 —— 只是去掉了 Box 部分。

---

## 缓冲器与 Klipper 集成（可能是本项目最具技术性的部分）  
Mellow LLL 缓冲器自带控制器，无法直接与 Klipper 通信。但它有两个按钮，分别处理手动“进料”和“退料”功能。我们可以利用这个功能将其集成到 Klipper 中。  

由于 Klipper/MCU 通常无法直接控制两个针脚之间的通断，所以无法直接在 MCU 上模拟按钮。但我们可以用两个 MOSFET 来完美模拟“按钮”。基本原理：MOSFET 有三个引脚，分别是 栅极(G)、漏极(D) 和 源级(S)。当在 G 和 S 之间施加高于阈值的电压时，D 和 S 导通，正好模拟了按钮的工作方式，只是可控化了。

---

### 简化流程  
1. 找到缓冲器 PCB 上的两个物理按钮（`feed` / `retract`）。  
2. 将每个按钮的两脚拆焊或并联连接到 MOSFET，作为数字开关。  
3. 用 Klipper 输出引脚（例如通过 `SET_PIN`）控制 MOSFET Gate。  
4. Klipper 现在就可以“按”这些按钮 —— 完全集成。  

这样既保持了缓冲器的内部逻辑，又让 Klipper 拥有完全控制权。  

---

## 优势  

- **成本低**：重复利用现有挤出机和组件。  
- **灵活**：可支持任意数量的耗材通道（仅受限于你的配置）。  
- **Klipper 原生**：所有逻辑和顺序可以直接写在 Klipper 宏中，无需额外 `/extra/whatever.py`。  
- **开放思路**：模块化、可适配 —— 只做你需要的部分。  

---

## 当前状态  

本项目目前**处于概念/WIP 阶段**。  
原型搭建正在进行，设计可能会演变。  

如果你决定尝试或改进这个概念，请**提交 Issue**或**PR** —— 我很希望看到你的版本！  

---

## 项目理念  

> *“不要重新发明轮子 —— 让它转得更聪明。”*  

本项目旨在以新的方式利用现有、经过验证的零件，而不是从零设计一切。  

如果你喜欢聪明的改造和低成本创新，这里就是你的位置。  

---

## 未来计划  

- 添加接线图和示例 Klipper 宏  
- 分享工具头传感器集成示例  
- 记录换色时序优化  
- 测试 ABS 和 PLA 的实际性能  

---

**许可证:** MIT  
**贡献者:** 你（希望如此！）  
