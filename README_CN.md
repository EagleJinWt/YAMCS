# 又一种多色解决方案（适用于Klipper 3D打印机）

**状态：** 进行中 / 早期概念

**目标：** 充分利用现有部件，不重复造轮子

---

## 概述

这个项目探索一种*低成本*、*模块化*的多色3D打印方案——不需要昂贵的AMS系统或复杂的伺服机构。

我们的思路不是构建一个全新的多材料系统，而是组合现有可靠部件，让**Klipper**来协调控制。

可以把它理解为：

> “四个挤出机 + 一个*智能*缓冲器 = 可用的多色系统”

---

## 核心组件

| 组件 | 描述 |
|------------|-------------|
| **主控板** | 如果你的主板有4个或更多空闲电机接口，就不需要。但使用独立主板会让维护更轻松。我选择了Mellow Fly的Micro4，这板子正合需求。 |
| **步进驱动** | A4988也能用，但推荐TMC2209/2208以便配置。注意：如果使用集成驱动的主板（比如我用的Micro4，顾名思义已经集成了驱动），就不需要额外购买驱动了。 |
| **挤出机** | 标准**BMG挤出机**——每个料道一个 |
| **缓冲单元** | **Mellow LLL缓冲器**（我找到的相对便宜的型号） |
| **传感器** |  - 每个料道一个**耗材传感器**（用于检测插入，触发加载过程）<br> - 工具头一个**耗材传感器**（用于检测和计时）<br>*不需要运动检测，带微动开关的普通传感器就行* |
| **耗材切刀** | 可选但推荐安装——提高换色成功率。不是必须的，调校好后通过端部成型也能工作。如果你用StealthBurner可以看看[Filamatrix](https://github.com/sorted01/Filametrix) |
| **MOSFET管 (x2)** | 用于模拟缓冲器控制板上的按钮按压。**BSS138/2N7002**之类的都可以，不需要大功率型号 |
| **四进一出适配器** | 我个人觉得拓竹P1系列用的那种最好用，实际上任何适配器都行，打印的也可以，只是顺不顺畅的区别 |

*不需要额外的安装硬件！所有都是现成部件，可以直接安装！*

不过话说回来，你可能还是需要一些额外的螺丝、螺母等。这里列出一些你可能需要备货的：

| 名称 | 描述 |
|------------|-------------|
| **M3 T型螺母** | 用于安装挤出机和缓冲器。有些BMG套件可能不附带，但组装机器时应该会剩下一些 |
| **热缩管** | 在PCB设计出来之前，或者你不想再花钱做PCB，热缩管在绝缘MOSFET方面会很有帮助 |

---

## 设计理念

有一天，我在考虑给3D打印机加个缓冲器。突然灵光一现：四个挤出机加一个缓冲器基本上就等于一个完美的多色系统。这比基于伺服的方案更简单稳定，还解决了所有烦人的同步问题。说实话，都不用我多说——看看拓竹、创想这些厂商的做法，你会发现他们基本也是这个思路。

但在DIY 3D打印社区，据我所知，唯一做类似方案的是**龟盒**。问题是他们的设置太复杂了：用了定制主板来驱动N20电机，还有一大堆铝型材做结构，成本一下就上去了。当然他们这么做也有原因——他们要在顶部承载四卷料。

我的方法不一样：让专门的耗材存储盒来承担重载（我也会包含我用的版本。很简单，它还自带回卷功能，但请务必查看stl文件夹里的README，如果读不懂可以搭配网页翻译食用），然后专注于多色系统本身的电子和机械部分。

你可能会想：“等等，这不就是MMU/兔子多色的思路吗？”确实，但他们的设计还是太复杂——用了丝杆、光轴，甚至还需要舵机。所以你可以把我的方案看作是一个能在普通Klipper主板上运行（不需要特殊的有刷电机驱动）并使用现成缓冲器的龟盒——但没有盒。

---

## 缓冲器与Klipper集成（可能是本项目最具技术性的部分）
Mellow LLL耗材缓冲器使用自己的控制器，无法直接与Klipper通信。但它有两个按钮用于手动“进料”和“回抽”功能。我们可以利用这个功能将其集成到Klipper中。由于klipper/通用MCU无法控制引脚间的导通，我们不能用MCU模拟按钮。但可以用两个MOSFET管，它能完美模拟“按钮”。基本上，MOSFET有三个引脚：栅极(G)、漏极(D)和源极(S)。当G和S之间施加的电压超过某个阈值时，D和S就会导通，这正好就是按钮的工作原理，只是变成了可控的方式。我可能会为此发布一个PCB设计，因为让MOSFET悬空不是最好的解决方案。

### 简化流程
1. 找到缓冲器PCB上的两个物理按钮（`进料`/`回抽`）
2. 将每个按钮解焊或并联连接到作为数字开关的MOSFET
3. 使用Klipper输出引脚控制MOSFET栅极
4. Klipper现在可以为你“按下”按钮——完全集成

这样既保持了缓冲器的内部逻辑完整，又让Klipper获得了完全控制权。

---

## 优势

- **成本效益高：** 重用现有挤出机和组件
- **灵活性强：** 适用于任意数量的料道（仅受你的设置限制）
- **原生Klipper支持：** 所有逻辑和序列都可以在你的Klipper宏中实现，不需要```/extra/whatever.py```
- **开放理念：** 模块化且可适配——按需构建

---

## 当前状态

这个项目目前处于**概念/进行中阶段**
原型制作正在进行中，设计可能会演进

如果你决定尝试或改进这个方案，请**提交Issue**或**提交PR**——我很想看看你的版本！

---

## 理念

> *“不要重复造轮子——要让轮子转得更聪明”*

这个项目旨在以新方式利用现有、经过实战检验的部件，而不是从头开始设计所有东西

如果你相信巧妙的奇技淫巧和低成本创新，那么你来对地方了

---

## 待办事项

- 添加被动回卷的组装手册
- 测试宏和配置
- 发布切片设置

---

## 相关链接

[ClockWork 2耗材传感器](https://www.printables.com/model/292186-stealthburner-clockwork-2-filament-sensor)

[Mellow LLL耗材缓冲器商品页面](https://item.taobao.com/item.htm?id=803615410921)

[耗材支架+被动回卷](stl/README.md)

---

**开源许可：** MIT

**贡献者：** 希望有你！
